#!/usr/bin/env bash
#
# Recursive Git Status

home=$(pwd)
is_first_iteration=1
dirs=$(find . -type d -name .git -prune -exec dirname {} \;)

for dir in $dirs; do
	cd "$dir" || exit

	test $is_first_iteration -eq 0 && echo
	is_first_iteration=0

	printf "\e[36m%s\e[0m:\n" "$dir"
	unpushed_commits=$(git log --branches --not --remotes --oneline | wc -l)
	printf "%s unpushed commits\n" "$unpushed_commits"
	git status --short

	cd "$home" || exit
done
