#!/usr/bin/env bash

repo=$1
desc=$2
owner="Bartol Deak"

[ -z "$repo" ] && echo "Must supply repository name" && exit 1
[ -z "$desc" ] && echo "Must supply repository description" && exit 1

ssh git@srv1 <<EOF
cd /srv/git
mkdir $repo
cd $repo
git init --bare
EOF

ssh srv1 <<EOF
echo | sudo tee -a /etc/cgitrc
echo repo.url=$repo | sudo tee -a /etc/cgitrc
echo repo.path=/srv/git/$repo | sudo tee -a /etc/cgitrc
echo repo.desc=$desc | sudo tee -a /etc/cgitrc
echo repo.owner=$owner | sudo tee -a /etc/cgitrc
EOF
